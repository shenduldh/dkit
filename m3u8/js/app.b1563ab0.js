(function(t){function e(e){for(var a,u,s=e[0],i=e[1],o=e[2],b=0,d=[];b<s.length;b++)u=s[b],Object.prototype.hasOwnProperty.call(r,u)&&r[u]&&d.push(r[u][0]),r[u]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a]);l&&l(e);while(d.length)d.shift()();return c.push.apply(c,o||[]),n()}function n(){for(var t,e=0;e<c.length;e++){for(var n=c[e],a=!0,s=1;s<n.length;s++){var i=n[s];0!==r[i]&&(a=!1)}a&&(c.splice(e--,1),t=u(u.s=n[0]))}return t}var a={},r={app:0},c=[];function u(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=t,u.c=a,u.d=function(t,e,n){u.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},u.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)u.d(n,a,function(e){return t[e]}.bind(null,a));return n},u.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return u.d(e,"a",e),e},u.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],i=s.push.bind(s);s.push=e,s=s.slice();for(var o=0;o<s.length;o++)e(s[o]);var l=i;c.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"05d1":function(t,e,n){"use strict";n("83fa")},5257:function(t,e,n){},5822:function(t,e,n){},"73cd":function(t,e,n){"use strict";n("9c2f")},"757a":function(t,e,n){"use strict";n("5822")},"7aab":function(t,e,n){"use strict";n("5257")},"83fa":function(t,e,n){},"9c2f":function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),r=Object(a["w"])("data-v-05556ad6");Object(a["l"])("data-v-05556ad6");var c={class:"body"},u=Object(a["e"])("p",{class:"display-4 text-center"},"m3u8下载器",-1),s=Object(a["e"])("p",{class:"lead text-center"},"testURL：http://1257120875.vod2.myqcloud.com/0ef121cdvodtransgzp1257120875/3055695e5285890780828799271/v.f230.m3u8",-1);Object(a["j"])();var i,o=r((function(t,e,n,r,i,o){var l=Object(a["p"])("Add"),b=Object(a["p"])("List");return Object(a["i"])(),Object(a["c"])("div",c,[u,s,Object(a["e"])(l),Object(a["e"])(b)])})),l={class:"card mb-2"},b=Object(a["e"])("div",{class:"card-header"},"添加任务",-1),d={class:"card-body"},f={class:"input-group mb-1"},p=Object(a["e"])("div",{class:"input-group-prepend"},[Object(a["e"])("span",{class:"input-group-text"},"URL")],-1),v={class:"input-group mb-1"},O=Object(a["e"])("div",{class:"input-group-prepend"},[Object(a["e"])("span",{class:"input-group-text"},"自定义名称")],-1);function j(t,e,n,r,c,u){return Object(a["i"])(),Object(a["c"])("div",l,[b,Object(a["e"])("div",d,[Object(a["e"])("div",f,[p,Object(a["v"])(Object(a["e"])("input",{type:"text",class:"form-control",placeholder:"请输入m3u8视频的链接","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.taskURL=e})},null,512),[[a["s"],t.taskURL]])]),Object(a["e"])("div",v,[O,Object(a["v"])(Object(a["e"])("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=function(e){return t.taskName=e}),placeholder:"默认为“任务+id”"},null,512),[[a["s"],t.taskName]])]),Object(a["e"])("button",{onClick:e[3]||(e[3]=function(){return t.addTask&&t.addTask.apply(t,arguments)}),class:"btn btn-primary"},"确定")])])}(function(t){t["Loading"]="Loading",t["Ready"]="Ready",t["Ok"]="OK",t["Fail"]="Fail"})(i||(i={}));var h=Object(a["f"])({setup:function(){var t=Object(a["g"])("taskList"),e=Object(a["n"])(""),n=Object(a["n"])(""),r=0,c=function(){var a=++r,c={id:a,name:n.value||"任务".concat(a),url:e.value,status:i.Loading,progress:0,chipArray:[]};t.push(c),e.value="",n.value=""};return{taskURL:e,addTask:c,taskName:n}}});h.render=j;var y=h,k=Object(a["w"])("data-v-3b9bb879");Object(a["l"])("data-v-3b9bb879");var m={class:"card"},g=Object(a["e"])("div",{class:"card-header"},"任务详情",-1),w={class:"card-body"},_={class:"btn-group mb-2"},R={class:"list-group"};Object(a["j"])();var L=k((function(t,e,n,r,c,u){var s=Object(a["p"])("TaskComp");return Object(a["i"])(),Object(a["c"])("div",m,[g,Object(a["e"])("div",w,[Object(a["e"])("div",_,[Object(a["e"])("button",{onClick:e[1]||(e[1]=function(){return t.changeWorkerStatus&&t.changeWorkerStatus.apply(t,arguments)}),class:"btn btn-dark"},Object(a["q"])(t.isRunning?"暂停":"开始"),1),Object(a["e"])("button",{onClick:e[2]||(e[2]=function(){return t.autoRetryAll&&t.autoRetryAll.apply(t,arguments)}),class:"btn btn-dark"},Object(a["q"])(t.isRetring?"关闭重试":"自动重试"),1)]),Object(a["e"])("ul",R,[(Object(a["i"])(!0),Object(a["c"])(a["a"],null,Object(a["o"])(t.taskList,(function(e){return Object(a["i"])(),Object(a["c"])("li",{class:"list-group-item",key:e.id},[Object(a["e"])(s,{task:e,manager:t.manager,remove:t.remove},null,8,["task","manager","remove"])])})),128))])])])})),C=(n("c740"),n("4160"),n("a434"),n("159b"),n("b0c0"),Object(a["w"])("data-v-896f87c4"));Object(a["l"])("data-v-896f87c4");var x={class:"lead"},S={class:"progress mb-1"},A={class:"btn-group"};Object(a["j"])();var T=C((function(t,e,n,r,c,u){var s=Object(a["p"])("Detail");return Object(a["i"])(),Object(a["c"])(a["a"],null,[Object(a["e"])("p",x,[Object(a["d"])(Object(a["q"])(t.task.name)+" ",1),Object(a["e"])("span",{onClick:e[1]||(e[1]=function(){return t.retryTask&&t.retryTask.apply(t,arguments)}),class:t.taskStatusClass},Object(a["q"])(t.task.status),3)]),Object(a["e"])("div",S,[Object(a["e"])("span",{class:"progress-bar progress-bar-striped",style:{width:Math.floor(100*t.task.progress/t.task.chipArray.length)+"%"}},null,4)]),Object(a["e"])("div",A,[Object(a["e"])("button",{onClick:e[2]||(e[2]=function(){return t.save&&t.save.apply(t,arguments)}),class:"btn btn-success btn-sm"},"保存"),Object(a["e"])("button",{onClick:e[3]||(e[3]=function(e){return t.remove(t.task.id)}),class:"btn btn-secondary btn-sm"},"删除"),Object(a["e"])("button",{onClick:e[4]||(e[4]=function(e){return t.isShowDetail=!t.isShowDetail}),class:"btn btn-info btn-sm"},"详情")]),Object(a["v"])(Object(a["e"])("div",null,[(Object(a["i"])(!0),Object(a["c"])(a["a"],null,Object(a["o"])(t.task.chipArray,(function(e,n){return Object(a["i"])(),Object(a["c"])(s,{key:n,chip:e,onClick:function(n){return t.retry(e)}},null,8,["chip","onClick"])})),128))],512),[[a["t"],t.isShowDetail]])],64)})),F=(n("a623"),n("4de4"),n("c975"),n("d81d"),n("ac1f"),n("1276"),Object(a["w"])("data-v-af22ea72")),I=F((function(t,e,n,r,c,u){return Object(a["i"])(),Object(a["c"])("div",{class:t.detailClass},null,2)})),q=Object(a["f"])({props:{chip:{type:Object,required:!0}},setup:function(t){var e=Object(a["n"])("rounded");return Object(a["u"])((function(){var n=t.chip.status;n!==i.Ready?n!==i.Ok?e.value="rounded red":e.value="rounded green":e.value="rounded gray"})),{detailClass:e}}});n("757a");q.render=I,q.__scopeId="data-v-af22ea72";var U=q,P=(n("d3b7"),function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];fetch(t).then((function(t){return n?t.arrayBuffer():t.text()})).then((function(t){return e.success&&e.success(t)})).catch((function(t){return e.fail&&e.fail(t)}))}),D=(n("5319"),function(t,e){e=e||location.href;var n="";if(/^http/.test(t))n=t;else if("/"===t[0]){var a=e.split("/");n=a[0]+"//"+a[2]+t}else n=e.replace(/\/[^/]*?$/,"/"+t);return n}),E=(n("3ca3"),n("ddb0"),n("2b3d"),function(t,e){var n=new Blob(t,{type:"video/MP2T"}),a=document.createElement("a");a.download=e+".ts",a.href=URL.createObjectURL(n),a.style.display="none",document.body.appendChild(a),a.click(),a.remove()}),M=function(t,e){var n=function(){P(t.url,{success:function(n){t.data=n,t.status=i.Ok,e.progress++},fail:function(){t.status=i.Fail}},!0)};return n.id=e.id,n},N=Object(a["f"])({components:{Detail:U},props:{task:{type:Object,required:!0},manager:{type:Object,required:!0},remove:{type:Function,required:!0}},setup:function(t){var e=Object(a["r"])(t),n=e.task,r=e.manager,c=function(e){e.status===i.Fail&&(e.status=i.Ready,t.manager.submit(M(e,n.value)))},u=function(){E(n.value.chipArray.map((function(t){return t.data})),n.value.name)},s=Object(a["n"])("");Object(a["u"])((function(){var t=n.value.status,e=n.value.chipArray;if(t===i.Ready)return s.value="badge badge-primary",void(e.length>0&&e.every((function(t){return t.status===i.Ok}))&&(n.value.status=i.Ok,s.value="badge badge-success",u()));t!==i.Fail?t!==i.Loading||(s.value="badge badge-secondary"):s.value="badge badge-danger cursor"}));var o=function(){P(n.value.url,{success:function(t){var e=t.split("\n"),c=e.filter((function(t){return t.toLowerCase().indexOf(".ts")>-1}));0!==c.length?(n.value.status=i.Ready,c.forEach((function(t){var e=Object(a["m"])({url:D(t,n.value.url),status:i.Ready});n.value.chipArray.push(e),r.value.submit(M(e,n.value))}))):n.value.status=i.Fail},fail:function(){n.value.status=i.Fail}})};Object(a["h"])((function(){o()}));var l=Object(a["n"])(!1),b=function(){n.value.status===i.Fail&&(n.value.status=i.Loading,o())};return{save:u,retry:c,isShowDetail:l,retryTask:b,taskStatusClass:s}}});n("7aab");N.render=T,N.__scopeId="data-v-896f87c4";var W=N,B=n("d4ec"),J=n("bee2"),V=[],z=function(){function t(){Object(B["a"])(this,t),this._timer=void 0,this._run()}return Object(J["a"])(t,[{key:"_run",value:function(){clearInterval(this._timer),this._timer=setInterval((function(){if(V.length>0){var t=V.shift();t()}}),1e3)}},{key:"_stop",value:function(){clearInterval(this._timer)}}]),t}(),K=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;Object(B["a"])(this,t),this.workers=[],this.workerCount=e;for(var n=this.workerCount;n--;)this.workers.push(new z)}return Object(J["a"])(t,[{key:"submit",value:function(t){V.push(t)}},{key:"stop",value:function(){this.workers.forEach((function(t){return t._stop()}))}},{key:"start",value:function(){this.workers.forEach((function(t){return t._run()}))}},{key:"remove",value:function(t){V=V.filter((function(e){return e.id!==t}))}}]),t}(),$=K,G=Object(a["f"])({components:{TaskComp:W},setup:function(){var t=Object(a["g"])("taskList"),e=new $(20),n=Object(a["n"])(!0),r=function(){n.value?e.stop():e.start(),n.value=!n.value},c=function(n){var a=t.findIndex((function(t){return t.id===n}));t.splice(a,1),e.remove(n)},u=Object(a["n"])(!1),s=void 0,o=function(){u.value?clearInterval(s):s=setInterval((function(){t.forEach((function(t){t.chipArray.forEach((function(n){n.status===i.Fail&&(n.status=i.Ready,e.submit(M(n,t)))}))}))}),2e3),u.value=!u.value};return{taskList:t,manager:e,isRunning:n,changeWorkerStatus:r,isRetring:u,autoRetryAll:o,remove:c}}});n("05d1");G.render=L,G.__scopeId="data-v-3b9bb879";var H=G,Q=Object(a["f"])({components:{Add:y,List:H},setup:function(){var t=Object(a["m"])([]);Object(a["k"])("taskList",t)}});n("73cd");Q.render=o,Q.__scopeId="data-v-05556ad6";var X=Q;Object(a["b"])(X).mount("#app")}});
//# sourceMappingURL=app.b1563ab0.js.map